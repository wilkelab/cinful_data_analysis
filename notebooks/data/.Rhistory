getwd()
read.csv("/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/e_coli_bothGTDBandNCBI.csv")
e_coli <- read.csv("/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/e_coli_bothGTDBandNCBI.csv")
set.seed(1)
length(e_coli)
length(e_coli$accession)
sample(e_coli$accession, n=length(e_coli$accession), size=2000)
sample(e_coli$accession, size=2000)
set.seed(1)
sample(e_coli$accession, size=2000)
set.seed(1)
sample(e_coli$accession, size=2000)
set.seed(1)
subset_e_coli <- sample(e_coli$accession, size=2000)
as.df(subset_e_coli)
make.df(subset_e_coli)
to_df(subset_e_coli)
to.df(subset_e_coli)
as.data.frame(subset_e_coli)
set.seed(1)
subset_e_coli <- as.data.frame(sample(e_coli$accession, size=2000))
View(subset_e_coli)
write.csv(subset_e_coli, "/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/e_coli_subset_2000.csv")
set.seed(2)
subset_e_coli <- as.data.frame(sample(e_coli$accession, size=2000))
e_coli <- read.csv("/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/e_coli_bothGTDBandNCBI.csv")
set.seed(2)
subset_e_coli <- as.data.frame(sample(e_coli$accession, size=2000))
write.csv(subset_e_coli, "/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/e_coli_subset_2000_seed2.csv")
hits <- read.csv("/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/e_coli_subset_cinful_run/best_hits.csv")
hits
hits$sample
unique(hits$sample)
count(unique(hits$sample))
unique(hits$sample)
library(dplyr)
hits %>% subset(component, "microcins.verified")
?subset
hits %>% subset(component == "microcins.verified" && hmmerHit == "True")
hits %>% subset(component == "microcins.verified" && hmmerHit == "True")
hits
hits %>% subset(component == "microcins.verified")
hits %>% subset(component == "microcins.verified")
hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True")
test1 <- hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True")
hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True") %>%
unique(sample)
hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True") %>%
unique(sample)
hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True") %>%
unique(sample)
hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True") %>%
unique(hits$sample)
hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True") %>%
unique()
hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True") %>%
unique()
hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True") %>%
unique(sample)
hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True") %>%
unique(hits$sample)
unique(test1$sample)
View(subset_e_coli)
343/1891
343/1891
343/1891
343/1891
e_coli_subset_2000_accessions_seed2 <- read.table("/run/user/1000/gvfs/sftp:host=wilkcomp01.ccbb.utexas.edu,user=alf3564/stor/work/Wilke/afeller/cinful/e_coli_2000_subset_seed2/e_coli_subset_2000_accessions_seed2.txt", quote="\"", comment.char="")
View(e_coli_subset_2000_accessions_seed2)
View(e_coli_subset_2000_accessions_seed2)
View(e_coli_subset_2000_accessions_seed2)
sample(e_coli_subset_2000_accessions_seed2, size = 109)
e_coli_subset_2000_accessions_seed2
View(e_coli_subset_2000_accessions_seed2)
sample(e_coli_subset_2000_accessions_seed2$V1, size = 109)
added_109_samples <- sample(e_coli_subset_2000_accessions_seed2$V1, size = 109)
added_109_samples <- as.data.frame(sample(e_coli_subset_2000_accessions_seed2$V1, size = 109))
View(added_109_samples)
added_109_samples <- as.data.frame(sample(e_coli_subset_2000_accessions_seed2$V1, size = 4))
View(added_109_samples)
added_109_samples <- as.data.frame(sample(e_coli_subset_2000_accessions_seed2$V1, size = 4))
View(added_109_samples)
added_109_samples <- as.data.frame(sample(e_coli_subset_2000_accessions_seed2$V1, size = 4))
View(added_109_samples)
added_109_samples <- as.data.frame(sample(e_coli_subset_2000_accessions_seed2$V1, size = 4))
View(added_109_samples)
added_109_samples <- as.data.frame(sample(e_coli_subset_2000_accessions_seed2$V1, size = 10))
View(added_109_samples)
hits_added <- read.csv("/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/e_coli_subset_cinful_run/best_hits_added_109.csv")
library(tidyverse)
install.packages("tidyverse")
library(dplyr)
library(tidyverse)
all_hits <- bind_rows(hits, hits_added)
length(unique(all_hits$sample))
test2 <- all_hits %>%
subset(component == "microcins.verified") %>%
subset(hmmerHit == "True")
length(unique(test2$sample))/2000
install.packages("tidyverse")
#install.packages("tidyverse")
Install.packages("ggtree")
#install.packages("tidyverse")
install.packages("ggtree")
install.packages("ggstance")
install.packages("ggtree")
version
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ggtree")
gc()
library(tidyverse)
install.packages("tidyverse")
install.packages("curl")
install.packages("curl")
install.packages("tidyverse")
getwd()
setwd("aaron@aaron-iMac:/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/microcins_enterobacterales/notebooks/data")
getwd()
setwd("/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/microcins_enterobacterales/notebooks/data")
getwd()
read.csv("Enterobacteriaciae_all_best_hits.csv")
getwd()
read.csv("Enterobacteriales_all_best_hits.csv")
hits <- read.csv("Enterobacteriales_all_best_hits.csv")
View(hits)
species <- read.csv("Enterobacteriales_species_merged_1000.csv")
View(species)
hits
View(hits)
species
library(tidyverse)
species <- read.csv("Enterobacteriales_species_merged_1000.csv") %>% select(accession, gtdb_taxonomy)
View(species)
hits_split <- hits %>% separate(cinful_id, sep = 15)
hits_split <- hits %>% separate(cinful_id, sep = 15, into = c('ID1','ID2') )
View(hits_split)
hits_split <- hits %>% separate(cinful_id, sep = 15, into = c('accession','ID2') )
left_join(hits_split, species)
testout <- left_join(hits_split, species)
View(testout)
out <- left_join(hits_split, species)
out$gtdb_taxonomy
out %>% separate(gtdb_taxonomy, sep = '; *__', into = c('d','p','c','o','f','g','s'))
out %>% separate(gtdb_taxonomy, sep = (pattern = '; .__'), into = c('d','p','c','o','f','g','s'))
out %>% separate(gtdb_taxonomy, sep = regex(pattern = '; .__'), into = c('d','p','c','o','f','g','s'))
wide_out <- out %>% separate(gtdb_taxonomy, sep = regex(pattern = '; .__'), into = c('d','p','c','o','f','g','s'))
wide_out <- out %>% separate(gtdb_taxonomy, sep = regex(pattern = '; .__'), into = c('d','p','c','o','f','g','s'))
wide_out <- out %>% separate(gtdb_taxonomy, sep = regex(pattern = ';? ?.__'), into = c('d','p','c','o','f','g','s'))
out %>% separate(gtdb_taxonomy, sep = regex(pattern = ';? ?.__'), into = c('d','p','c','o','f','g','s'))
out %>% separate(gtdb_taxonomy, sep = '__', into = c('d','p','c','o','f','g','s'))
wide_out <- out %>% separate(gtdb_taxonomy, sep = '__', into = c('d','p','c','o','f','g','s'))
View(wide_out)
View(hits)
View(testout)
wide_out <- out %>% separate(gtdb_taxonomy, sep = ';__', into = c('NA','d','p','c','o','f','g','s'))
wide_out <- out %>% separate(gtdb_taxonomy, sep = ';__', into = c('oops','d','p','c','o','f','g','s'))
View(wide_out)
wide_out <- out %>% separate(gtdb_taxonomy, sep = '__', into = c('oops','d','p','c','o','f','g','s'))
View(wide_out)
View(out)
hits_split <- hits %>% separate(sample, sep = 15, into = c('accession','ID2') )
out <- left_join(hits_split, species)
View(hits_split)
hits_split <- hits %>% separate(sample, sep = 15, into = c('accession','ID2') )
out <- left_join(hits_split, species)
View(out)
write.csv("Enterobacteriales_hits_with_species_data.csv")
getwd()
write.csv("Enterobacteriales_hits_with_species_data.csv")
write.csv(out, "Enterobacteriales_hits_with_species_data.csv")
species <- read.csv("Enterobacteriales_species_merged_1000.csv") %>% select(accession, gtdb_taxonomy)
species
setwd("/media/aaron/33cc2fea-ce13-4ebb-b0fe-45bb99026799/microcins_enterobacterales/notebooks/data")
library(tidyverse)
species <- read.csv("Enterobacteriales_species_merged_1000.csv") %>% select(accession, gtdb_taxonomy)
species
species <- read.csv("Enterobacteriales_species_merged_1000.csv")
downloads <- read.csv("Enterobacteriales_accessions.txt")
View(species)
true_species <- downloads %>% left_join(species)
View(downloads)
downloads <- read.csv("Enterobacteriales_accessions.txt", header = FALSE)
true_species <- downloads %>% left_join(species)
View(species)
View(downloads)
downloads <- read.csv("Enterobacteriales_accessions.txt", header = FALSE) %>% rename(V1 = accession)
downloads <- read.csv("Enterobacteriales_accessions.txt", header = FALSE) %>% rename(accession = V1)
true_species <- downloads %>% left_join(species)
View(true_species)
View(downloads)
downloads <- read.csv("Enterobacteriales_accessions.txt", header = FALSE) %>%
rename(accession = V1) %>%
separate(accession, c('accession', 'added'), sep = 15)
View(downloads)
true_species <- downloads %>% left_join(species)
View(true_species)
View(species)
View(downloads)
View(true_species)
View(species)
View(true_species)
write.csv(true_species, "Enterobacteriales_accessions.csv")
